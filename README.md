# doko_mc_ai

This is a monte carlo based artificial intelligence for playing the card game
of 'Doppelkopf'.

## How to compile it

The project uses CMake for configuring and compilation. On a GNU/Linux system you should be able to build the project
with the following commands if you have a CMake and a recent C compiler installed.

    $ mkdir build
    $ cd build
    $ cmake .. -DCMAKE_BUILD_TYPE=Release
    $ cmake --build .

## Source overview

The sources are alltogether located in the `src` directory.

  - `random` This module contains a fast xorshift pseudo random generator (prg).
    It is needed, as the standard library rand() prg suffers from enormeous
    performance issues if used in a multithreaded program.
  - `simulate` This module contains functions to perform a random simulation ofa
    game. The input are hypothetical games with a specific card distribution
    generated by the mc module.
  - `mc` This module contains functions to randomly distribute cards to the
    players.
  - `core` This is the core module. It handles the creation and joining of
    worker threads.

A typical call to these inner modules enters at the `GetBestCard` function of
the `core` module. There, worker threads are started. Each thread repeatedly
calls the `mc_sample` function from the `mc` module to randomly distribute the
left cards to the other players. On the sampled hypothetical game, a simulation
is run. The result is reported back to the `GetBestCard` function. Here, the
next card, that on average achieved the best score, is selected and returned. 

## Doxygen

Most code is commented using doxygen format. You can build the doxygen
documentation by calling

    $ doxygen

in the root directory. New functions should always be annotated with a detailed
doxygen description of what it does and how it is used in the header file. The
source file on the other hand should contain detailed comments (non-doxygen)
that explain, how it is done.

The generated documentation is published at the
[project github io page](https://jakob-stark.github.io/doko_mc_ai/).

## TODO

The following topics need improvements and you are welcome to contribute.

  - The frontend/ui does not check if the game that is played is legal. It
    should detect obvious errors such as a card is existent more than two times
    or a player does not play according to the rules. At the moment such corrupt
    input does invalidate the results at best and crash the program at worst.

  - The frontend/ui is very very basic, does not allow correction an errorneous
    input and does not check for valid input.

  - A separation of the frontend from the core is in planning. Some kind of
    protocol (perhaps json based) would be nice. This would enable a server
    client model, where different uis could act as clients and get the best
    next moves from a core server, that performs the calculations.
